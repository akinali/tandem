(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b589140a"],{"0636":function(e,t,n){"use strict";n("44f3")},"084e":function(e,t,n){},"1abb":function(e,t,n){},"2d7a":function(e,t,n){"use strict";n("1abb")},"44f3":function(e,t,n){},"83fc":function(e,t,n){"use strict";n("084e")},"90df":function(e,t,n){"use strict";n.r(t);n("b0c0");var s=n("7a23"),a=Object(s["I"])("data-v-866bab6a");Object(s["t"])("data-v-866bab6a");var c={style:{"text-align":"left"}},i={class:"panel panel-default"},o={class:"card"},l={style:{margin:"auto",padding:"10px 0px 10px 0"}},r={key:0},d={class:"panel-body msg_container_base",style:{height:"700px"}},u={class:"panel-footer"},b={class:"input-group"},h={class:"input-group-btn"};Object(s["r"])();var g=a((function(e,t,n,a,g,m){var p=Object(s["x"])("MessageSent"),f=Object(s["x"])("MessageRecieved");return Object(s["q"])(),Object(s["d"])("div",c,[Object(s["h"])("div",i,[Object(s["h"])("div",o,[Object(s["h"])("label",l,Object(s["z"])(g.friend.name+" "+g.friend.surname),1),g.disabled?(Object(s["q"])(),Object(s["d"])("label",r,"Aktifleşmesi bekleniyor...")):Object(s["e"])("",!0)]),Object(s["h"])("div",d,[(Object(s["q"])(!0),Object(s["d"])(s["a"],null,Object(s["w"])(g.messages,(function(e){return Object(s["q"])(),Object(s["d"])("div",{key:e},[e.isSent?(Object(s["q"])(),Object(s["d"])(p,{key:0,message:e,me:g.user},null,8,["message","me"])):(Object(s["q"])(),Object(s["d"])(f,{key:1,message:e,friend:g.friend},null,8,["message","friend"]))])})),128))]),Object(s["h"])("div",u,[Object(s["h"])("div",b,[Object(s["G"])(Object(s["h"])("input",{id:"btn-input",type:"text",class:"form-control input-sm chat_input",placeholder:"Write your message here...","onUpdate:modelValue":t[1]||(t[1]=function(e){return g.message=e}),disabled:g.disabled,onKeyup:t[2]||(t[2]=Object(s["H"])((function(){return m.sendMessage&&m.sendMessage.apply(m,arguments)}),["enter"]))},null,40,["disabled"]),[[s["D"],g.message]]),Object(s["h"])("span",h,[Object(s["h"])("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=function(){return m.sendMessage&&m.sendMessage.apply(m,arguments)}),id:"btn-chat"}," Send ")])])])])])})),m=(n("7db0"),Object(s["I"])("data-v-628a75f0"));Object(s["t"])("data-v-628a75f0");var p={class:"row msg_container base_receive"},f=Object(s["h"])("div",{class:"col-md-2 col-xs-2 avatar",style:{"max-width":"67px"}},[Object(s["h"])("img",{src:"http://www.bitrebels.com/wp-content/uploads/2011/02/Original-Facebook-Geek-Profile-Avatar-1.jpg",class:"img-responsive"})],-1),j={class:"col-md-10 col-xs-10"},O={class:"messages msg_receive"},v={style:{"margin-right":"0px"}},_=Object(s["h"])("time",{datetime:"2009-11-13T20:00"},"Timothy • 51 min",-1);Object(s["r"])();var k=m((function(e,t,n,a,c,i){return Object(s["q"])(),Object(s["d"])("div",p,[f,Object(s["h"])("div",j,[Object(s["h"])("div",O,[Object(s["h"])("p",null,Object(s["z"])(n.message.message),1),Object(s["h"])("label",v,"["+Object(s["z"])(n.friend.name)+"]",1),_])])])})),w={props:{message:Object,friend:Object}};n("83fc");w.render=k,w.__scopeId="data-v-628a75f0";var y=w,x=Object(s["I"])("data-v-30eaa5a9");Object(s["t"])("data-v-30eaa5a9");var q={class:"row msg_container base_sent"},S={class:"col-md-10 col-xs-10"},I={class:"messages msg_sent"},M={style:{"margin-right":"0px"}},F=Object(s["h"])("time",{datetime:"2009-11-13T20:00"},"Timothy • 51 min",-1),C=Object(s["h"])("div",{class:"col-md-2 col-xs-2 avatar",style:{"max-width":"67px"}},[Object(s["h"])("img",{src:"http://www.bitrebels.com/wp-content/uploads/2011/02/Original-Facebook-Geek-Profile-Avatar-1.jpg",class:"img-responsive"})],-1);Object(s["r"])();var R=x((function(e,t,n,a,c,i){return Object(s["q"])(),Object(s["d"])("div",q,[Object(s["h"])("div",S,[Object(s["h"])("div",I,[Object(s["h"])("p",null,Object(s["z"])(n.message.message),1),Object(s["h"])("label",M,"["+Object(s["z"])(n.me.name)+"]",1),F])]),C])})),$={props:{message:Object,me:Object}};n("0636");$.render=R,$.__scopeId="data-v-30eaa5a9";var z=$,A={components:{MessageRecieved:y,MessageSent:z},data:function(){return{friend:null,connection:null,user:null,messages:[],message:null,channel:{id:null,user1_id:null,user2_id:null},disabled:!0}},methods:{createRequestForChat:function(e){var t=this;this.$http.request("post","api/v1/channels/"+e,null,!0).then((function(e){console.log(e),t.channel.id=e.data.elements[0],t.channel.user1_id=t.user.id,t.channel.user2_id=t.friend.id}))},getFriendInfo:function(e){this.friend=this.user.friends.find((function(t){return t.id==e}))},getUserInfoFromApi:function(e){var t=this;this.$http.request("get","api/v1/users/"+this.$util.getUserInfo().id,null,!0).then((function(n){t.user=n.data.elements[0],t.getFriendInfo(e),t.createRequestForChat(e)}))},sendMessage:function(){console.log("bu kullanıcı mesajıdır . ",this.message),this.messages.push({isSent:!0,message:this.message}),this.connection.send(this.message),this.message=""},checkRequestForChat:function(){var e=this,t=setInterval((function(){null!=e.channel.id&&e.$http.request("get","api/v1/channels/"+e.channel.id,null,!0).then((function(n){console.log(n),n.data.successfull&&(clearInterval(t),e.disabled=!1,e.webSocketCreater())}))}),3e3)},webSocketCreater:function(){console.log("Starting connection to WebSocket Server");var e=this;e.connection=new WebSocket("ws://192.168.1.36:4444"),e.connection.onopen=function(e){console.log(e),console.log("Successfully connected to the echo websocket server...")};var t=e.channel.id+"__-__"+e.channel.user1_id+"__-__"+e.channel.user2_id+"__-__"+localStorage.getItem("token");this.connection.onerror=function(e){console.log("WebSocket Error "+e)},this.connection.onmessage=function(t){console.log("Server: "+t.data),t.data&&"Ping"!=t.data&&e.handleIncomeMessage(t.data)},setTimeout((function(){e.connection.send(t)}),1e3)},handleIncomeMessage:function(e){console.log(e),this.messages.push({isSent:!1,message:e})}},mounted:function(){var e=this.$router.currentRoute.value.query.data;console.log("chat panel ",e),this.getUserInfoFromApi(e),this.disabled=!0,this.checkRequestForChat()},unmounted:function(){this.$http.request("delete","api/v1/channels/"+this.channel.id,null,!0).then((function(e){console.log(e)})),this.connection.send("CLOSED_ME_BYE")}};n("2d7a");A.render=g,A.__scopeId="data-v-866bab6a";t["default"]=A}}]);
//# sourceMappingURL=chunk-b589140a.69277343.js.map